# 0. Introduction to Pentesting

An overview of what a penetration test involves

## Pentesting Fundamentals

Before looking at the technical aspects of ethical hacking, we need to understand more about the responsibilities of a penetration tester and the processes that are followed when performing penetration tests.

A *pentration test* or *pentest* is an **ethically-driven** attempt to test and analyse the security defences used to protect digital assets and information. A pentest involves using the same tools, techniques and methodologies that someone with malicious intent would use.

### Penetration Testing Ethics

Recall that a pentest is an **authorised audit** of a computer system's security and defences as agreed by the owners of the system. Thus, the legality of a pentest is clear-cut -- anything that falls outside of the agreement is deemed unauthorised.

Before a pentest, a formal discusstion should occure between the penetration teter and the system owner. The various tools, techniques, and systems to be tested are agreed upon and this forms the scope of the pentesting agreement. 

The *Rules of Engagement(ROE)* is a document that is created at the initial stages of a pentesting engagement. The doucment consists of three main sections, which are ultimately responsible for deciding how the engagement is carried out. 

* **Permission**: gives explicit permission for the engagement to be carrried out -- legally protects individuals and organisations for the activities they carry out.
* **Test Scope**: annotates the specific targets to which the engagement should apply.
* **Rules**: defines the exact techniques that are permitted during the engagement.

### Penetration Testing Methodologies

The steps a penetration tester takes during an engagement is known as the methodology. A practical methodology is a smart one, where the steps taken are relevant to the situation at hand. For example, having a methodology used to test web applications is **not practical** when the task is to test a network. 

In general, methodologies involve a number of stages:
1. **Information gathering**: collecting as much **publically** available information about the target via research (no scanning of any systems).
2. **Enumeration/Scanning**: discovering applications and services running on the systems.
3. **Exploitation**: leveraging vulnerabilities in applications or services running on the system.
4. **Privilege Escalation**: attempting to expand access to a system once it is sucessfully exploited.
5. **Post-exploitation**
   1. What other hosts can be targeted? 
   2. What additional information can we gather as the privileged user?
   3. Covering tracks
   4. Reporting

---

**Open Source Security Testing Methodology Manual (OSSTMM)**

The [OSSTMM](https://www.isecom.org/OSSTMM.3.pdf) provides a detailed framework of testing strategies for systems, software, applications, communications and the human aspect of cybersecurity. 

The framework focuses primarily on how these systems and applications communicate. Thus, it includes methodologies for:
* telecommunications,
* wired networks, and 
* wireless communications.

**Advantages**:
* Covers various testing strategies in-depth.
* Includes testing strategies for specific targets.
* Flexible depending on the organisation's needs
* Intended to set a standard for systems and applications, meaning that a universal methodology can be used for pentesting.

**Disadvantages**:
* Difficult to understand
* Very detailed
* Uses unique definitions

---

**Open Web Application Security Project (OWASP)**

The [OWASP](https://owasp.org/) framework is a community-driven and frequently updated framework used solely to test the security of web applications and services. 

Regular [reports](https://owasp.org/www-project-top-ten/2017/) are published, stating the top ten security vulnerabilities a web application may have, the testing approach, and remediation.

**Advantages**:
* Easy to pick up and understand.
* Actively maintained and is frequently updated.
* Covers all stages of an engagement -- from testing to reporting and remediation.
* Specialises in web applications and services.

**Disadvantages**:
* It may not be clear what type of vulnerability a web application has as they often overlap.
* OWASP does not make suggesstions to any specific software development life cycles.
* The framework does not hold any accreditation.

---

**NIST Cybersecurity Framework 1.1**

The [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework) is a popular framework used to improve an organisation's cybersecurity standards and manage the risk of cyber threats. 

The framework provides guidelines on security controls and benchmarks success for organisations. There is also a section that provides a guideline for the methodology a penetration tester should take.

**Advantages**:
* Estimated to be used by 50% of American organisations as of 2020.
* Extremely detailed in setting standards to help organisations mitigate the threat posed by cyber threats.
* Frequently updated.
* NIST provides accreditation for organisations that use this framework.
* Designed to be implemented alongside other frameworks.
  
**Disadvantages**:
* There are many iterations of the framework, so it may be difficult to decide which one applies.
* The framework has weak auditing policies, making it difficult to determine how a breach occurred.
* The framework does not currently consider cloud computing, which is becoming increasingly popular for organisations. 

---

**National Cyber Security Centre Cyber Assessment Framework (NCSC CAF)**

The [CAF](https://www.ncsc.gov.uk/collection/caf/caf-principles-and-guidance) is an extensive framework of 14 principles used to assess the risk of various cyber threats and an organisation's defences against these.

The framework applies to organisations considered to perform "vitally important services and activities" such as critical infrastructure, banking, etc. The framework mostly focuses on and assesses the following topics:
* Data security
* System security
* Identity and access control
* Resiliency
* Monitoring
* Response and recovery planning

**Advantages**:
* Backed by a government cybersecurity agency.
* Provides accreditation
* Covers 14 principles ranging from security to response

**Disadvantages**:
* The framework is relatively new, meaning that organisations have not had much time to make the necessary changes to be suitable for it.
* Based on principles and ideas that is not as direct as having rules.

### Black-, White- and Grey-box Penetration Testing

There are **three** primary scopes when testing an application or service. The level of understanding of the targer determines the level of testing that is performed in the engagement.

**Black-box Testing**

This testing process is a high-level process where the tester is **not** given any information about the inner workings of the application or service. 

The tester acts as a regular user testing the functionality and interaction of the application or a piece of software. This testing can involve interacting with the interface, and observing whether the intended result is returned. 

Black-box testing generally takes more time in the information gathering and enumeration phase to understand the attack surface of the target.

**Grey-box Testing**

This is the most popular process for penetration testing. The tester will have **limited** knowledge of the internal components of the application or software. Still, the process involves interacting with the application as if it were a black-box, and then resolving issues as they are found using the knowledge of the application. 

Knowledge of the application, albeit limited, saves time. Thus, grey-box testing is often chosen for extremely well-hardened attack surfaces.

**White-box Testing**

This is a low-level testing process, usually done by a software developer familiar with programming and application logic. The tester will test the internal components of the application or piece of software and, for example, ensure that specific functions work correctly wand within a reasonable amount of time.

The tester has **full** knowledge of the application and its expected behaviour. White-box testing is the most time consuming, but it guarantees that the entrie attack surface can be validated.

![Testing scopes](./img/boxes.png "Testing scopes")

## Principles of Security

In this section, we outline some of the fundamental principles of information security -- from the frameworks used to protect data and systems, to the elements of what exactly make data secure.

The measures, frameworks and protocols discussed throughout this section all play a small part in "Defence in Depth". 

*Defence in Depth* is the use of multiple varied layers of security in the hopes that multiple layers will provide redundancy in an organisation's security perimeter. 

### The CIA triad

The CIA triad is an information security model that is used in consideration throughout creating a security policy. 

Consisting of three sections: **C**onfidentiality, **I**ntegrity and **A**vailability (CIA), this model has quickly become an industry standard today. The model should help to determine the value of the data that it applies to, which in turn determines the attention it needs from organisation. 

![The CIA triad](./img/cia_triad.png "The CIA triad")

The CIA triad is unlike a traditional model where there are individual sections. Instead, it is a continuous cycle. Whilst the three elements can overlap, if even one element is not met, then the other two are rendered useless. Thus, if a security policy does not address all the three sections, it is seldom an effective security policy. 

